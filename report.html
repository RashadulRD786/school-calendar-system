<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Report Export - Admin Dashboard</title>
  <link href="https://fonts.googleapis.com/css2?family=Wix+Madefor+Display&display=swap" rel="stylesheet"/>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: "Wix Madefor Display", sans-serif;
      background-color: #fff;
    }

    .dashboard-container {
      display: flex;
      flex-direction: column;
      width: 100vw;
      height: 100vh;
      background-color: #fff;
      overflow: hidden;
    }

    .dashboard-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      width: 100%;
      padding: 16px 26px;
      border-bottom: 2px solid rgba(0, 0, 0, 0.15);
      background-color: #008B8B;
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .logo-container {
      width: 50px;
      height: 50px;
      overflow: hidden;
      border-radius: 8px;
    }

    .logo-image {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .header-text {
      display: flex;
      flex-direction: column;
    }

    .company-name {
      font-size: 26px;
      font-weight: 600;
      color: white;
    }

    .company-tagline {
      font-size: 14px;
      color: white;
    }

    .welcome-message {
      font-size: 20px;
      color: white;
      font-weight: 500;
    }

    .notification-container {
      display: flex;
      align-items: center;
    }

    .notification-button {
      position: relative;
      background: none;
      border: none;
      cursor: pointer;
      padding: 8px;
      border-radius: 50%;
      transition: background-color 0.2s;
    }

    .notification-button:hover {
      background-color: #f5f5f5;
    }

    .notification-icon {
      width: 28px;
      height: 28px;
    }

    .notification-dropdown {
      position: absolute;
      top: 100%;
      right: 0px;
      width: 300px;
      background-color: #fff;
      border: 1px solid #e8e8e8;
      border-radius: 4px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      padding: 16px;
      z-index: 10;
    }

    .notification-title {
      font-size: 16px;
      font-weight: 500;
      margin-bottom: 12px;
    }

    .notification-message {
      font-size: 14px;
      color: #666;
    }

    .dashboard-content {
      display: flex;
      flex: 1;
      border-top: 1px solid #e8e8e8;
    }

    .sidebar {
      width: 250px;
      background-color: #20B2AA;
      border-right: 2px solid #e8e8e8;
      padding: 20px 0 0 0;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      height: calc(100vh - 90px);
    }

    .nav-links {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .nav-links a {
      text-decoration: none;
      color: inherit;
    }

   .nav-button {
  padding: 12px 24px;
  background: none;
  border: none;
  cursor: pointer;
  text-align: left;
  font-size: 16px;
  color: #FFFFFF; /* Changed from #333 to White */
  transition: all 0.2s;
}

.nav-button:hover {
  background-color: rgba(255, 255, 255, 0.1); /* Changed from #f5f5f5 to subtle white overlay */
  color: #FFFFFF; /* Ensure color stays white on hover */
}
    .sidebar .nav-button.active {
  background-color: #1A9086; /* Changed from #ebebeb to a slightly darker turquoise */
  color: #FFFFFF; /* Ensures text color for active button is white */
  text-decoration: none; /* Remove underline */
}

    .logout-button {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px 24px;
  background: none;
  border: none;
  cursor: pointer;
  width: 100%;
  text-align: left;
  font-size: 16px;
  color: #FFFFFF; /* Changed from #ed0b0e (Red) to White for consistency */
  transition: all 0.2s;
  margin-top: auto;
  border-top: 2px solid #e8e8e8;
}

.logout-button:hover {
  background-color: rgba(255, 255, 255, 0.1); /* Changed from #fff1f1 to subtle white overlay */
  color: #FFFFFF; /* Ensure color stays white on hover */
}
    .container {
      flex: 1;
      padding: 40px;
      background-color: #fafafa;
    }

    .container h2 {
      margin-bottom: 20px;
      font-size: 24px;
      color: #333;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-group label {
      display: block;
      margin-bottom: 8px;
      color: #555;
    }

    .form-group input[type="date"] {
      width: 100%;
      padding: 10px;
      font-size: 16px;
      border: 1px solid #ccc;
      border-radius: 6px;
    }

    .form-group select {
    width: 100%;
    padding: 10px;
    font-size: 16px;
    border: 1px solid #ccc;
    border-radius: 6px;
    background-color: #fff;
  }


    .button-group {
      margin-top: 20px;
    }

    .btn-export {
      background-color:  #20B2AA;
      color: white;
      border: none;
      padding: 10px 24px;
      font-size: 16px;
      border-radius: 6px;
      cursor: pointer;
      transition: background-color 0.2s;
    }

    .btn-export:hover {
      background-color: #006666;
    }
  </style>
</head>
<body>
  <div class="dashboard-container">
    <header class="dashboard-header">
      <div class="header-left">
        <div class="logo-container">
          <img
            src="SMKLOGO.png"
            alt="EventFlow Logo"
            class="logo-image"
          />
        </div>
        <div class="header-text">
          <h1 class="company-name">SK SAUJANA UTAMA</h1>
          <p class="company-tagline">Event Management System</p>
        </div>
      </div>
      <div class="welcome-message">Welcome Admin 👋</div>
      <div class="notification-container">
          <button class="notification-button" data-el="button-1">
            <svg viewBox="0 0 53 58" fill="none" class="notification-icon">
              <rect width="53" height="57" fill="none"></rect>
              <path
                d="M5.58695 34.1858C5.11735 37.3994 7.21688 39.6297 9.78749 40.7412C19.6427 45.0029 33.3574 45.0029 43.2125 40.7412C45.7832 39.6297 47.8827 37.3994 47.4132 34.1858C47.1246 32.2109 45.6975 30.5665 44.6402 28.9608C43.2553 26.8316 43.1178 24.5093 43.1175 22.0386C43.1175 12.4904 35.6777 4.75 26.5 4.75C17.3225 4.75 9.88262 12.4904 9.88262 22.0386C9.8824 24.5093 9.7448 26.8316 8.35993 28.9608C7.30265 30.5665 5.87556 32.2109 5.58695 34.1858Z"
                stroke="#FFFFFF"
                stroke-width="3"
                stroke-linecap="round"
                stroke-linejoin="round"
              ></path>
              <path
                d="M19.875 53.4375C21.6331 54.9145 23.9549 55.8125 26.5 55.8125C29.0451 55.8125 31.3669 54.9145 33.125 53.4375"
                stroke="#FFFFFF"
                stroke-width="3"
                stroke-linecap="round"
                stroke-linejoin="round"
              ></path>
            </svg>
            <span id="notification-badge" style="position:absolute;top:2px;right:2px;background:#ed1c24;color:#fff;font-size:13px;font-weight:600;padding:2px 7px;border-radius:12px;display:none;z-index:11;"></span>
            <div class="notification-dropdown" data-el="div-1" hidden>
              <h3 class="notification-title">Notifications</h3>
              <p class="notification-message">No new notifications</p>
            </div>
          </button>
        </div>
    </header>

    <div class="dashboard-content">
      <nav class="sidebar">
        <div class="nav-links">
          <a href="admin-dashboard1.html" class="nav-button dashboard-btn">Dashboard</a>
         
          <a href="reports.html" class="nav-button reports-btn active">Reports</a>
           <a href="delete_events.html" class="nav-button reports-btn ">Delete Events</a>
          <a href="user-management/user-management.php" class="nav-button users-btn">Admin</a>
        </div>
        <a href="index.html" class="logout-button">
          <svg viewBox="0 0 24 24" width="20" height="20" fill="none">
            <path d="M9 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V5C3 4.46957 3.21071 3.96086 3.58579 3.58579C3.96086 3.21071 4.46957 3 5 3H9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
            <path d="M16 17L21 12L16 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
            <path d="M21 12H9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
          </svg>
          <span>Logout</span>
        </a>
      </nav>

      <div class="container">
        <h2>Report Export</h2>
              <form id="exportForm" method="POST" action="report.php">
          <div class="form-group">
            <label for="from">From Date</label>
            <input type="date" id="from" name="from" required />
          </div>
          <div class="form-group">
            <label for="to">To Date</label>
            <input type="date" id="to" name="to" required />
          </div>
                    <div class="form-group">
              <label for="status">Status:</label>
              <select name="status" id="status">
                <option value="any">Any</option>
                <option value="Complete">Complete</option>
                <option value="Non-Complete">Non-Complete</option>
              </select>

          </div>

          <div class="button-group">
            <button type="submit" class="btn-export">Export</button>
          </div>
        </form>

      </div>
    </div>
  </div>
  <!-- Notification Modal & Dropdown System -->
  <div id="event-modal" class="modal" style="display:none;">
    <div class="modal-content">
      <span class="close" id="close-modal">&times;</span>
      <h2 id="modal-event-name"></h2>
      <p><strong>Date:</strong> <span id="modal-event-date"></span></p>
      <p><strong>Time:</strong> <span id="modal-event-time"></span></p>
      <p><strong>Location:</strong> <span id="modal-event-location"></span></p>
      <p><strong>Description:</strong> <span id="modal-event-description"></span></p>
      <div class="modal-actions">
        <button id="edit-event-btn" class="btn-edit">Edit</button>
        <button id="delete-event-btn" class="btn-delete">Delete</button>
      </div>
    </div>
  </div>
<script src="report.js"></script>
<script>
// --- Notification Modal Styles ---
const modalStyle = document.createElement('style');
modalStyle.textContent = `
.modal {
  display: none;
  position: fixed;
  z-index: 9999;
  left: 0;
  top: 0;
  width: 100vw;
  height: 100vh;
  overflow: auto;
  background-color: rgba(0,0,0,0.35);
}
.modal-content {
  background-color: #fff;
  margin: 60px auto;
  padding: 32px 28px 24px 28px;
  border: 1px solid #e8e8e8;
  border-radius: 12px;
  width: 400px;
  max-width: 95vw;
  box-shadow: 0 4px 24px rgba(32,178,170,0.18);
  position: relative;
}
.close {
  color: #888;
  position: absolute;
  top: 18px;
  right: 22px;
  font-size: 28px;
  font-weight: bold;
  cursor: pointer;
}
.close:hover {
  color: #ed1c24;
}
.modal-actions {
  display: flex;
  gap: 12px;
  margin-top: 18px;
}
.btn-edit {
  background: #20B2AA;
  color: #fff;
  border: none;
  border-radius: 6px;
  padding: 8px 18px;
  font-size: 15px;
  font-weight: 500;
  cursor: pointer;
  transition: background 0.2s;
}
.btn-edit:hover {
  background: #008B8B;
}
.btn-delete {
  background: #ed1c24;
  color: #fff;
  border: none;
  border-radius: 6px;
  padding: 8px 18px;
  font-size: 15px;
  font-weight: 500;
  cursor: pointer;
  transition: background 0.2s;
}
.btn-delete:hover {
  background: #b30000;
}
`;
document.head.appendChild(modalStyle);
// --- Notification Dropdown Logic ---
let currentEventId = null;
function viewEventDetails(eventId) {
  fetch('get_events.php?id=' + eventId)
    .then(res => res.json())
    .then(event => {
      currentEventId = eventId;
      document.getElementById('modal-event-name').textContent = event.name;
      document.getElementById('modal-event-date').textContent = event.date;
      document.getElementById('modal-event-time').textContent = event.time;
      document.getElementById('modal-event-location').textContent = event.location;
      document.getElementById('modal-event-description').textContent = event.description || '';
      document.getElementById('event-modal').style.display = 'block';
    })
    .catch(err => {
      alert('❌ Failed to load event details.');
    });
}
document.getElementById('close-modal').onclick = function() {
  document.getElementById('event-modal').style.display = 'none';
};
window.onclick = function(event) {
  const modal = document.getElementById('event-modal');
  if (event.target === modal) {
    modal.style.display = 'none';
  }
};
document.getElementById('edit-event-btn').onclick = function() {
  if (!currentEventId) return;
  window.location.href = 'edit_event.php?id=' + currentEventId;
};
document.getElementById('delete-event-btn').onclick = function() {
  if (!currentEventId) return;
  if (confirm('Are you sure you want to delete this event?')) {
    fetch('delete_event.php?id=' + currentEventId, { method: 'POST' })
      .then(res => res.text())
      .then(result => {
        alert('Event deleted successfully.');
        document.getElementById('event-modal').style.display = 'none';
        fetchNotifications();
      })
      .catch(err => {
        alert('❌ Failed to delete event.');
      });
  }
};
function updateNotificationBadge(count) {
  const badge = document.getElementById('notification-badge');
  if (count > 0) {
    badge.textContent = count;
    badge.style.display = 'inline-block';
  } else {
    badge.style.display = 'none';
  }
}
function fetchNotifications() {
  fetch('get_notifications.php')
    .then(res => res.json())
    .then(data => {
      const dropdown = document.querySelector('[data-el="div-1"]');
      const badgeCount = data.unread_count || 0;
      updateNotificationBadge(badgeCount);
      // Preserve scroll position
      let scrollableDiv = dropdown.querySelector('.notification-scroll');
      let prevScrollTop = scrollableDiv ? scrollableDiv.scrollTop : 0;
      if (data.notifications && data.notifications.length > 0) {
        dropdown.innerHTML = `
          <h3 class="notification-title">Notifications</h3>
          <div style="margin-bottom:10px;text-align:right;">
            <button id="mark-read-btn" style="background:#008080;color:white;border:none;padding:6px 14px;border-radius:6px;cursor:pointer;font-size:13px;font-weight:500;">Mark all as read</button>
          </div>
          <div class="notification-scroll" style="max-height:320px;overflow-y:auto;">
            ${data.notifications.map(n => `
              <div class="notification-card" style="background:${n.read ? '#fff' : '#ECECEC'};font-weight:${n.read ? 'normal' : 'bold'};margin-bottom:10px;padding:13px 14px 10px 14px;border-radius:9px;box-shadow:0 2px 8px rgba(32,178,170,0.10);cursor:pointer;transition:box-shadow 0.2s;display:flex;flex-direction:column;gap:4px;">
                <div style="display:flex;justify-content:space-between;align-items:center;">
                  <span style="text-align:left;color:#008080;font-size:15px;">New event added: ${n.eventName}</span>
                </div>
                <div style="display:flex;justify-content:flex-end;align-items:center;margin-top:2px;">
                  <span style="font-size:12px;color:#888;text-align:right;">${n.eventDate} ${n.eventTime}</span>
                </div>
                <div style="display:flex;justify-content:flex-end;align-items:center;margin-top:2px;">
                  <button style="background:none;border:none;color:#20B2AA;font-size:13px;cursor:pointer;padding:0;" onclick="viewEventDetails(${n.eventId})">View Details</button>
                </div>
              </div>
            `).join('')}
          </div>
        `;
        // Restore scroll position
        scrollableDiv = dropdown.querySelector('.notification-scroll');
        if (scrollableDiv) scrollableDiv.scrollTop = prevScrollTop;
        const markBtn = document.getElementById('mark-read-btn');
        if (markBtn) {
          markBtn.onclick = function() {
            fetch('mark_notifications_read.php', { method: 'POST' })
              .then(res => res.json())
              .then(() => fetchNotifications());
          };
        }
      } else {
        dropdown.innerHTML = '<h3 class="notification-title">Notifications</h3><p class="notification-message">No new notifications</p>';
      }
    });
}
setInterval(fetchNotifications, 1000);
document.addEventListener('DOMContentLoaded', fetchNotifications);
</script>
</body>
</html>